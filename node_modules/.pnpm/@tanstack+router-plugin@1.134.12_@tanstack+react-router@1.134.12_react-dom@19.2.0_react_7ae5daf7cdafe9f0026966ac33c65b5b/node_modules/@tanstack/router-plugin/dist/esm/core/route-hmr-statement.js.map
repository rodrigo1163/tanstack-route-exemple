{"version":3,"file":"route-hmr-statement.js","sources":["../../../src/core/route-hmr-statement.ts"],"sourcesContent":["import * as template from '@babel/template'\nimport type { AnyRoute, AnyRouteMatch } from '@tanstack/router-core'\n\ntype AnyRouteWithPrivateProps = AnyRoute & {\n  _path: string\n  _id: string\n  _fullPath: string\n  _to: string\n}\n\nfunction handleRouteUpdate(\n  oldRoute: AnyRouteWithPrivateProps,\n  newRoute: AnyRouteWithPrivateProps,\n) {\n  newRoute._path = oldRoute._path\n  newRoute._id = oldRoute._id\n  newRoute._fullPath = oldRoute._fullPath\n  newRoute._to = oldRoute._to\n  newRoute.children = oldRoute.children\n  newRoute.parentRoute = oldRoute.parentRoute\n\n  const router = window.__TSR_ROUTER__!\n  router.routesById[newRoute.id] = newRoute\n  router.routesByPath[newRoute.fullPath] = newRoute\n  const oldRouteIndex = router.flatRoutes.indexOf(oldRoute)\n  if (oldRouteIndex > -1) {\n    router.flatRoutes[oldRouteIndex] = newRoute\n  }\n  const filter = (m: AnyRouteMatch) => m.routeId === oldRoute.id\n  if (\n    router.state.matches.find(filter) ||\n    router.state.pendingMatches?.find(filter)\n  ) {\n    router.invalidate({ filter })\n  }\n}\n\nexport const routeHmrStatement = template.statement(\n  `\nif (import.meta.hot) {\n  import.meta.hot.accept((newModule) => {\n    if (Route && newModule && newModule.Route) {\n      (${handleRouteUpdate.toString()})(Route, newModule.Route)\n    }\n   })\n}\n`,\n  // Disable placeholder parsing so identifiers like __TSR_ROUTER__ are treated as normal identifiers instead of template placeholders\n  { placeholderPattern: false },\n)()\n"],"names":[],"mappings":";AAUA,SAAS,kBACP,UACA,UACA;AACA,WAAS,QAAQ,SAAS;AAC1B,WAAS,MAAM,SAAS;AACxB,WAAS,YAAY,SAAS;AAC9B,WAAS,MAAM,SAAS;AACxB,WAAS,WAAW,SAAS;AAC7B,WAAS,cAAc,SAAS;AAEhC,QAAM,SAAS,OAAO;AACtB,SAAO,WAAW,SAAS,EAAE,IAAI;AACjC,SAAO,aAAa,SAAS,QAAQ,IAAI;AACzC,QAAM,gBAAgB,OAAO,WAAW,QAAQ,QAAQ;AACxD,MAAI,gBAAgB,IAAI;AACtB,WAAO,WAAW,aAAa,IAAI;AAAA,EACrC;AACA,QAAM,SAAS,CAAC,MAAqB,EAAE,YAAY,SAAS;AAC5D,MACE,OAAO,MAAM,QAAQ,KAAK,MAAM,KAChC,OAAO,MAAM,gBAAgB,KAAK,MAAM,GACxC;AACA,WAAO,WAAW,EAAE,QAAQ;AAAA,EAC9B;AACF;AAEO,MAAM,oBAAoB,SAAS;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA,SAIO,kBAAkB,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMnC,EAAE,oBAAoB,MAAA;AACxB,EAAA;"}